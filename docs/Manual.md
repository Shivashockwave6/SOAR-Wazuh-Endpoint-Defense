# SOAR System User Manual

Welcome to the SOAR (Security Orchestration, Automation, and Response) system user manual. This guide provides detailed instructions for operating the system, which integrates Wazuh for endpoint defense, Shuffle for automation, and TheHive for case management.

## Table of Contents

1. **Introduction**
   - Overview of the SOAR System
     The SOAR system combines security orchestration, automation, and response capabilities to streamline incident response, enhance threat detection, and automate repetitive tasks in cybersecurity operations.
   - Key Components
     - **Windows 10**: Endpoint running Wazuh agent and Sysmon for advanced event logging.
     - **Wazuh Manager**: Centralized SIEM and EDR platform for monitoring and managing security events.
     - **Shuffle**: SOAR platform that automates responses and enriches data using external APIs like VirusTotal.
     - **TheHive**: Case management system for organizing and tracking security incidents.

2. **Installation**
   - **Prerequisites**
     - Virtual environment (e.g., VirtualBox) for Windows 10 and Ubuntu.
     - Access to public IPs and necessary ports for communication.
   - **Installation Steps**
     - **Windows 10 Setup**
       - Install and configure Sysmon for advanced event monitoring.
       - Deploy and configure Wazuh agent to send Sysmon logs to Wazuh manager.
       - Install MIMIKATZ for credential dumping simulation.
     - **Wazuh Manager on Ubuntu**
       - Install Wazuh manager using curl commands and configure based on documentation.
       - Set up Elasticsearch and Cassandra for data storage and retrieval.
     - **TheHive Installation**
       - Install Java, Cassandra, and Elasticsearch dependencies.
       - Configure Cassandra and Elasticsearch for optimal performance.
       - Install and configure TheHive for case management.
     - **Shuffle Configuration**
       - Sign up for Shuffle and configure integration with Wazuh and TheHive.
       - Add VirusTotal API integration for automated data enrichment.
       
3. **Configuration**
   - **Windows 10 Configuration**
     - Detailed steps to install and configure Sysmon for specific event IDs relevant to security monitoring.
     - Instructions to modify Wazuh agent configuration (`ossec.conf`) to integrate Sysmon logs.
   - **Wazuh Manager Configuration**
     - Setting up rules and alerts in Wazuh manager for detecting security incidents.
     - Configuring active responses for automated actions based on detected threats.
   - **TheHive Configuration**
     - Detailed instructions on configuring Cassandra and Elasticsearch for TheHive.
     - Steps to set up user permissions and API access for integration with Shuffle.
   - **Shuffle Configuration**
     - Step-by-step guide to configuring automation rules in Shuffle using Wazuh alerts and VirusTotal API.
     - Integration setup with TheHive for automated case creation and management.

4. **Implementation**
   - **Use Cases and Scenarios**
     - **MIMIKATZ Detection and Response**
       - Scenario: Detecting credential dumping with MIMIKATZ using Wazuh alerts.
       - Workflow: Automating incident response and case creation in TheHive via Shuffle.
     - **IP Blocking and Firewall Rules**
       - Scenario: Blocking suspicious IP addresses detected by Wazuh on Ubuntu endpoint.
       - Workflow: Using Wazuh active response to block IPs and updating firewall rules.
     - **Phishing Domain Detection**
       - Scenario: Detecting and analyzing phishing domains using Shuffle and VirusTotal.
       - Workflow: Automating domain reputation checks and alerting SOC analyst via email.
   
5. **User Operations**
   - **Accessing and Navigating TheHive**
     - Instructions for SOC analysts to log in, create cases, and manage incidents in TheHive.
   - **Using Shuffle for Automation**
     - Guide on setting up automation rules and workflows in Shuffle for various security use cases.
   - **SOC Analyst Workflow**
     - Managing email notifications and responding to alerts generated by Shuffle and Wazuh.
     - Best practices for incident investigation and response using integrated tools.

6. **Advanced Topics**
   - **Customizing Rules and Alerts in Wazuh**
     - Advanced configurations for creating custom rules and alerts based on specific security requirements.
   - **Enhancing Automation with Cortex and MISP**
     - Integrating Cortex for additional data enrichment and response capabilities.
     - Utilizing MISP for threat intelligence sharing and integration with TheHive.

7. **Troubleshooting**
   - **Common Issues and Solutions**
     - Troubleshooting tips for common setup, configuration, and operational issues.
   - **Logging and Monitoring**
     - Guide to monitoring system logs and events in Wazuh and Elasticsearch for proactive maintenance.

8. **Conclusion**
   - **Best Practices for Operating the SOAR System**
     - Recommendations for maintaining system security and performance.
   - **Future Enhancements and Updates**
     - Ideas for future upgrades and features to enhance the SOAR system's capabilities.

## Conclusion

This user manual serves as a comprehensive guide to help you effectively operate and manage the SOAR system integrated with Wazuh for endpoint defense. Regularly refer to this manual for updates and additional configurations as your security operations evolve.

For detailed technical documentation, refer to the respective files in this repository.

